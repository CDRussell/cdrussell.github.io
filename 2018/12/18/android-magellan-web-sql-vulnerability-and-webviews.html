<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Android Magellan Web SQL Vulnerability and WebViews | craigrussell</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="Android Magellan Web SQL Vulnerability and WebViews" />
<meta name="author" content="Craig Russell" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Are Android WebViews vulnerable to Magellan vulnerability?" />
<meta property="og:description" content="Are Android WebViews vulnerable to Magellan vulnerability?" />
<link rel="canonical" href="https://cdrussell.github.io//2018/12/18/android-magellan-web-sql-vulnerability-and-webviews" />
<meta property="og:url" content="https://cdrussell.github.io//2018/12/18/android-magellan-web-sql-vulnerability-and-webviews" />
<meta property="og:site_name" content="craigrussell" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-12-18T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Android Magellan Web SQL Vulnerability and WebViews" />
<script type="application/ld+json">
{"description":"Are Android WebViews vulnerable to Magellan vulnerability?","url":"https://cdrussell.github.io//2018/12/18/android-magellan-web-sql-vulnerability-and-webviews","@type":"BlogPosting","headline":"Android Magellan Web SQL Vulnerability and WebViews","dateModified":"2018-12-18T00:00:00+00:00","datePublished":"2018-12-18T00:00:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://cdrussell.github.io//2018/12/18/android-magellan-web-sql-vulnerability-and-webviews"},"author":{"@type":"Person","name":"Craig Russell"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  </head>
  <body>
    <div class="wrapper">
      <header >
        <a href='https://cdrussell.github.io//'>
          <h1>craigrussell</h1>
          
            <p>Technical blog from Craig Russell.</p>
          
        </a>

        <nav>
  <div style="
         top: 0px;
         right: 0px;
         position: absolute">

    <a href="/about">
      <figure>
        <img src="/images/me-round.png"
             style="
              height: 50px;
              display: block;
              margin-left: auto;
              margin-right: auto;
              "
             alt="Photo of me, wearing a bright yellow t-shirt with a bright blue, cloudy sky in the background"
        />
        <figcaption style="text-align:justify" >About me</figcaption>
      </figure>
    </a>
  </div>
</nav>


        <p> </p>
      </header>
      <section>

      <h1 id="android-magellan-web-sql-vulnerability-and-webviews">Android Magellan Web SQL Vulnerability and WebViews</h1>
<p><em>Are Android WebViews vulnerable to Magellan?</em></p>

<h2 id="background-reading">Background Reading</h2>
<p>A <a href="https://blade.tencent.com/magellan/index_en.html">recently reported vulnerability</a> provides some information on a bug called <strong>Magellan</strong> which allows an attacker to execute arbitrary SQL, but how does this affect an Android app which uses a <code class="language-plaintext highlighter-rouge">WebView</code>? Are <code class="language-plaintext highlighter-rouge">WebViews</code> vulnerable?</p>

<p>Mark Murphy (aka commonsware) provides <a href="https://commonsware.com/blog/2018/12/15/sqlite-magellan-bug-your-app.html">an excellent write up </a>on the situation which details the vulnerability and risk (or lack thereof) for most Android app developers. On <code class="language-plaintext highlighter-rouge">WebViews</code> he notes that:</p>

<blockquote>
  <p>Android’s WebView supports WebSQL, apparently (I have not used it personally). If you allow the user to view arbitrary Web content in a WebView, your app may be at risk. If, however, you are only loading your own content (e.g., help pages packaged as assets), you may be safe.</p>
</blockquote>

<h2 id="webviews-and-magellan">WebViews and Magellan</h2>
<p>It would appear that you can enable or disable <code class="language-plaintext highlighter-rouge">WebSQL</code> functionality within your app: when configuring a <code class="language-plaintext highlighter-rouge">WebView</code> you can also configure its <code class="language-plaintext highlighter-rouge">WebSettings</code>.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">val</span> <span class="py">webView</span><span class="p">:</span> <span class="nc">WebView</span> <span class="p">=</span> <span class="nf">findViewById</span><span class="p">(</span><span class="nc">R</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">webView</span><span class="p">)</span>

<span class="c1">// disable Web SQL</span>
<span class="n">webView</span><span class="p">.</span><span class="n">settings</span><span class="p">.</span><span class="n">databaseEnabled</span> <span class="p">=</span> <span class="k">false</span>
</code></pre></div></div>

<p><a href="https://developer.android.com/reference/android/webkit/WebSettings.html#setDatabaseEnabled%28boolean%29">From the official docs</a>, and empirically, <code class="language-plaintext highlighter-rouge">databaseEnabled</code> should default to false. This means <strong>you should not be vulnerable to Magellan unless you’ve chosen to enable that feature explicitly</strong>.</p>

<h3 id="testing-if-web-sql-is-enabled-in-your-app">Testing if Web SQL is Enabled in your App</h3>

<p>You can try this <a href="https://andrew.hedges.name/html5/sql.html">client-side storage demo</a> website to check if your WebView supports WebSQL or not.</p>


<a href='https://cdrussell.github.io//'>Home</a>


      </section>
    </div>
    <footer>
    </footer>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
  </body>
</html>
